# Settings for registry, node settings
dir name:
/etc/containers/registries.conf.d/10-registry.apps.<your-domain>.conf

# example
[[registry]]
prefix = "registry.apps.k8s.<your-domain>"
insecure = true
blocked = false
location = "registry.apps.k8s.<your-domain>"

[[registry.mirror]]
location = "registry.apps.k8s.<your-domain>"
insecure = true

# another settings

/etc/containers/policy.json
Этот файл определяет, какие реестры и образы считаются доверенными (используется библиотека containers/image).

Пример содержимого:

json
{
  "default": [
    {
      "type": "insecureAcceptAnything"
    }
  ],
  "transports": {
    "docker": [
      {
        "prefix": "my-internal-registry:5000",
        "insecure": true
      }
    ]
  }
}
Что важно:

default — политика по умолчанию для всех реестров.

transports.docker — настройки для Docker‑реестров (можно указать отдельные правила для конкретных реестров).

insecure: true — разрешить небезопасные соединения для указанного реестра.

Как проверить текущую политику:

bash
cat /etc/containers/policy.json

# if use short name for image in your template such as nginx and registry.conf contain invalid/not-ative url/location for registry you will get an error below
3m11s       Warning   InspectFailed   pod/title   Failed to inspect image "nginx": rpc error: code = Unknown desc = short-name "nginx:latest" did not resolve to an alias and no containers-registries.conf(5) was found
# if you use full name for image with prefix such as docker.io/library/nginx or your own/private registry it will pull image from such registry 
# even you have incorrect/not-active registry location in your registry.conf

# default and additions files for crio
1. Основной файл конфигурации: /etc/containers/registries.conf
2. Дополнительные файлы: Директория /etc/containers/registries.conf.d/

Если в основной директории /etc/containers/ отсутствует файл registries.conf, CRI-O начнёт проверять дополнительную директорию /etc/containers/registries.conf.d/.
